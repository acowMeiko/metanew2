==========================================
BBH 数据集 DPO 数据生成 (每个任务独立保存)
==========================================
GPU: 0,1
批次大小: 128
并发数: 30
输出目录: output/bbh
==========================================

BBH 共有 27 个任务 (每个任务独立保存)

----------------------------------------
处理任务 [1/27]: boolean_expressions
----------------------------------------
开始生成 DPO 数据...
输出文件: output/bbh/dpo_boolean_expressions.jsonl
2025-12-27 09:29:29,394 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,394 - __main__ - INFO - 数据集名称: bbh
2025-12-27 09:29:29,394 - __main__ - INFO - 数据集路径: dataset/bbh/boolean_expressions.json
2025-12-27 09:29:29,394 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,394 - __main__ - INFO - 使用数据集适配层加载: bbh
2025-12-27 09:29:29,394 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,394 - __main__ - INFO - [数据集适配层] 开始加载数据集: bbh
2025-12-27 09:29:29,394 - __main__ - INFO - [数据集适配层] 文件路径: dataset/bbh/boolean_expressions.json
2025-12-27 09:29:29,394 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,396 - __main__ - INFO - [数据集适配层] 已加载 JSON 文件
2025-12-27 09:29:29,396 - __main__ - INFO - 预处理 BBH 数据集: 250 条
2025-12-27 09:29:29,396 - __main__ - INFO - [数据集适配层] 预处理完成: 250 条有效数据
2025-12-27 09:29:29,396 - __main__ - INFO - [数据集适配层] 数据格式已统一为: {'question': str, 'answer': str}
2025-12-27 09:29:29,396 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,396 - __main__ - INFO - 数据集加载成功，共 250 条数据
2025-12-27 09:29:29,396 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,396 - __main__ - INFO - Step 1: 开始生成DPO数据
2025-12-27 09:29:29,396 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,397 - __main__ - INFO - 未发现已有进度，将从头开始处理
2025-12-27 09:29:29,397 - __main__ - INFO - 共需处理 250 条数据，批次大小: 64
2025-12-27 09:29:29,397 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,397 - __main__ - INFO - 阶段1/3: vLLM分批本地推理（所有数据）
2025-12-27 09:29:29,397 - __main__ - INFO - ============================================================
2025-12-27 09:29:29,397 - __main__ - INFO - 处理批次 [1-128/250]
2025-12-27 09:29:29,398 - __main__ - INFO -   → 生成Baseline答案 (128 条)...
2025-12-27 09:29:29,398 - __main__ - INFO - 批量生成Baseline答案: 128 条
INFO 12-27 09:29:34 [__init__.py:239] Automatically detected platform cuda.
2025-12-27 09:29:34,901 - inference.local_inference - INFO - 使用环境变量 CUDA_VISIBLE_DEVICES: 0,1
2025-12-27 09:29:34,901 - inference.local_inference - INFO - ============================================================
2025-12-27 09:29:34,901 - inference.local_inference - INFO - 初始化vLLM本地模型...
2025-12-27 09:29:34,901 - inference.local_inference - INFO - 模型路径: /home/share/hcz/qwen2.5-14b-awq
2025-12-27 09:29:34,901 - inference.local_inference - INFO - ============================================================
`torch_dtype` is deprecated! Use `dtype` instead!
INFO 12-27 09:29:41 [config.py:585] This model supports multiple tasks: {'generate', 'reward', 'classify', 'embed', 'score'}. Defaulting to 'generate'.
INFO 12-27 09:29:41 [config.py:1519] Defaulting to use mp for distributed inference
INFO 12-27 09:29:41 [config.py:1697] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 12-27 09:29:46 [__init__.py:239] Automatically detected platform cuda.
